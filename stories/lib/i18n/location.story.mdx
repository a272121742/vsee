import { Story, Preview, Meta, Props } from '@storybook/addon-docs/blocks';

<Meta title="框架/国际化/配置方案" />

# 国际化

`vsee`框架中分成了三种国际化层次：全局国际化、模块国际化、组件国际化。其优先级别是“组件 > 模块 > 全局”，下面给各位分别进行讲解。

## 全局国际化

全局国际化都是提取的前端比较常见的名词或者通用业务名词。在设计时，遵循如下规范：

| 类型              | 词性                                             |
| ----------------- | ------------------------------------------------ |
| action (交互类)   | 动词，例如： create、remove、update、find等      |
| status (状态类)   | 名词/形容词，例如：disabled、enabled、loading等  |
| feedback (反馈类) | 名词/动词，例如：info、warn、error等             |
| domain (建模类)   | 名词，例如：id、cd、no等，用于与后端领域建模配合 |

当然，除了以上4大类型外，还有一些通用组件类型大国际化块，例如：`form`、`page`、`password`等，他们内部并不区分国际化字段的类型，只是按照业务进行区分。

<Preview>
<Story name="全局国际化字段" height="320px">
{{
  template: `
    <locale-table></locale-table>
  `
}}
</Story>
</Preview>

> 注意：全局国际化字段不可变更，但可以重写，重写部分在模块国际化中覆盖定义即可。

## 模块国际化

由于`vsee`框架是按照业务模块化进行划分，并且每个模块都包含六层结构，其中都会包含`locale`国际化模块。这个模块可有可无，如果存在，则会加载模块内的国际化内容。下面展示每个模块的结构以及国际化层的结构：

```
@  // vsee项目的根
  - projects       // vsee项目的全部项目
  - projectName    // 一个vsee项目
    - layout       // 布局模块
      - locales    // 国际化层（弃用）
        - en.json  // 英文国际化（弃用）
        - cn.json  // 中文国际化（弃用）
    - module1      // 业务模块1
      - locales    // 国际化层
        - en.json  // 英文国际化
        - cn.json  // 中文国际化
    - module2      // 业务模块2
      - locales    // 国际化层
        - en.json  // 英文国际化
        - cn.json  // 中文国际化
```

由于加载的时候，是按照文件目录的顺序进行加载，因此，你并无法保证项目模块优先与layout加载的。因此，在新的`vsee`体系中，不建议在`layout`中定义全局的国际化配置。当然这里仍然会被读取到，稍后我们将移除这里的模块。

国际化的配置方式如下：

```
// en.json
{
  "issue": "Issue",
  "reback": "Reback",
  "issue_error": "Issue Error"
}
// zh.json
{
  "issue": "问题管理",
  "reback": "回滚",
  "issue_error": "问题错误"
}
```

这里，有三点需要我们注意：

1. 这里严格按照`JSON`的配置方式进行配置（`JSON`文件），是无法使用`JavaScript`所使用的`Object-JSON`的，因此你需要频繁书写双引号。为什么不采用`Object-JSON`，其目的就是为了防止开发人员使用小技巧进行一些特殊处理，也避免出现重复定义而出现的覆盖现象；
2. `en.json`、`zh.json`的命名是按照国际标准取用`PrimaryTag`来显示名称的，因此你也必须这么照做；
3. 字段的命名方式不能包含除了下划线`_`以外的字符串，虽然内部没有检测，但我们不建议那么随意，使用下划线命名法将使得代码的可读性更强。

## 组件国际化

由于我们使用的`vue-i18n`支持[单组件国际化](http://kazupon.github.io/vue-i18n/zh/guide/sfc.html)，使得我们可以按照如下风格来编写单文件组件：

```html
<i18n>
{
  "en": {
    "hello": "hello world!"
  },
  "zh": {
    "hello": "你好世界！""
  }
}
</i18n>

<template>
  <!-- ... -->
</template>

<script>
export default {
  // ...
}
</script>
```

看见没，你可以直接插入`<i18n>`标签来写`JSON`，以进行组件国际化。注意，这里仍然是严格的`JSON`，并非`Object-JSON`格式，这也是为啥国际化模块要做成`.json`文件的缘故了，一致性和移植性会更好。组件国际化会覆盖模块国际化，因此组件国际化是最优先的。如果你定一个某个组件，有着组件自己的逻辑和国际化方案，并且真正与其他模块、组件是相互隔离的（边界一定要严格弄清楚），那么这种方案是最合适的。否则，还是将国际化的内容定义在模块中，放入模块的好处是整个项目都是可用的。

> 注意，在以往的版本中，组件国际化是屏蔽模块国际化和全局国际化的。因此内部没有采用`merge`模式，因此一旦书写了组件国际化，在组件内想使用其他模块或者其他组件的国际化，是需要通过传递参数并且重新绑定函数的（`trans: _self.$t.bind(_self)`）。现在没有这个问题，你可以很安心的使用。

## 注意事项

`vsee`提供的国际化方案只是逻辑上的分模块和组件，但是其他模块和组件都可以使用甚至是覆盖。因此，定义和使用国际化字段应该自觉的使用隔离的原则，避免乱用。

更多的使用方式请参阅[vue-i18n](http://kazupon.github.io/vue-i18n/zh/)官方文档，`vsee`仅仅是对他的模式做了一点封装。